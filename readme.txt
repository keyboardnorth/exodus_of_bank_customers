Проектная работа: Отток клиентов из банка

Цель работы:
«Бета-Банка» начал терять клиентов. Сохранять текущих клиентов дешевле, чем привлекать новых. Необходимо построить модель прогноза оттока клиентов из банка с предельно большим значением F1-меры (не менее 0.59).
Также требуется измерить AUC-ROC, сопоставив её значение с F1-мерой.

Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

Ход работы:

1) исследование исходных данных;
2) предобработка данных;
3) определение дисбаланса;
4) подбор алгоритма;
5) подбор гипермараметров;
6) тестирование

Вывод:
* Создана модель с метриками качества на валидационной выборке: f1 = 0.662, TPR = 0.642, FPR = 0.075, AUC-ROC = 0.874.
* Таким образом модель верно детектирует 64.2% клиентов на отток.
* Модель прошла проверку на вменяемось. Сравнивалась с константной (f1=0.339) и случайной (f1=0.301).
* Проведена проверка на тестовой выборке: f1=0.593, AUC-ROC=0.855.
* Модель построена на базе алгоритма RandomForestClassifier с гиперпараметрами: depth=9, n_estimators=140, random_state=12345 с учётом порога классификации 0.33.

Вывод (уточнённый с описанием построенных моделей):

Отрицательное влияние дисбаланса нивелировалось разными методами с достижением результатов:
class_weight
(LR) f1 =0.528, AUC-ROC = 0.794
(DTC) f1(max)=0.576 при глубине 6, (AUC-ROC=0.823)
(RFC) f1(max)=0.650 при глубине 10 и числе деревьев 60, (AUC-ROC=0.867)
upsampling
(LR) f1 =0.525, AUC-ROC = 0.794
(DTC) f1(max)=0.576 при глубине 6, (AUC-ROC=0.823)
(RFC) f1(max)=0.649 при глубине 10 и числе деревьев 180, (AUC-ROC=0.871)
downsampling
(LR) f1 =0.528, AUC-ROC = 0.792
(DTC) f1(max)=0.595 при глубине 6 (AUC-ROC=0.849)
(RFC) f1(max)=0.621 при глубине 9 и числе деревьев 180, (AUC-ROC=0.866)
порог классификации
(LR) f1(max) = 0.526 при threshold = 0.240, (AUC-ROC = 0.787)\
(RFC) f1(max) = 0.662 при threshold = 0.33, глубине 9, числе деревьев 140 (AUC-ROC = 0.874)

Лучший результат метрик с алгоритмом RandomForestClassifier при использовании порога классификации.